function FrontBase(){}function getCookie(t){var e=null;if(document.cookie&&""!==document.cookie)for(var n=document.cookie.split(";"),o=0;o<n.length;o++){var s=jQuery.trim(n[o]);if(s.substring(0,t.length+1)===t+"="){e=decodeURIComponent(s.substring(t.length+1));break}}return e}FrontBase.prototype.run=function(){this.listenAuthBoxHover()},FrontBase.prototype.listenAuthBoxHover=function(){var t=$(".auth-box"),e=$(".user-more-box");t.hover(function(){e.show()},function(){e.hide()})};var myajax={get:function(t){t.method="get",this.ajax(t)},post:function(t){t.method="post",this._ajaxSetup(),this.ajax(t)},ajax:function(t){$.ajax(t)},_ajaxSetup:function(){$.ajaxSetup({beforeSend:function(t,e){/^(GET|HEAD|OPTIONS|TRACE)$/.test(e.type)||this.crossDomain||t.setRequestHeader("X-CSRFToken",getCookie("csrftoken"))}})}};function Auth(){var t=this;t.maskWrapper=$(".mask-wrapper"),t.scrollWrapper=$(".scroll-wrapper"),t.smsCaptcha=$(".sms-captcha-btn")}Auth.prototype.run=function(){var t=this;t.listenShowHideEvent(),t.listenSwitchEvent(),t.listenSigninEvent(),t.listenImgCaptchaEvent(),t.listenSmsCaptchaEvent()},Auth.prototype.showEvent=function(){this.maskWrapper.show()},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.listenShowHideEvent=function(){var t=this,e=$(".signin-btn"),n=$(".signup-btn"),o=$(".close-btn");e.click(function(){t.showEvent(),t.scrollWrapper.css({left:0})}),n.click(function(){t.showEvent(),t.scrollWrapper.css({left:-400})}),o.click(function(){t.hideEvent()})},Auth.prototype.listenSwitchEvent=function(){var e=this;$(".switch").click(function(){var t=e.scrollWrapper.css("left");(t=parseInt(t))<0?e.scrollWrapper.animate({left:"0"}):e.scrollWrapper.animate({left:"-400px"})})},Auth.prototype.listenSigninEvent=function(){var s=this,t=$(".signin-group"),a=t.find("input[name='telephone']"),i=t.find("input[name='password']"),c=t.find("input[name='remember']");t.find(".submit-btn").click(function(t){t.preventDefault();var e=a.val(),n=i.val(),o=c.prop("checked");xfzajax.post({url:"/account/login/",data:{telephone:e,password:n,remember:o?1:0,csrfmiddlewaretoken:$("#csrf_token").val()},success:function(t){if(console.log(t),200===t.code)s.hideEvent(),window.location.reload();else{console.log("Login failed.");var e=t.message;if("string"==typeof e||e.constructor==String)console.log(e),window.messageBox.show(e);else for(var n in e){var o=e[n][0];console.log(o),window.messageBox.show(o)}}},fail:function(t){console.log(t)}})})},Auth.prototype.listenImgCaptchaEvent=function(){var t=$(".img-captcha");t.click(function(){t.attr("src","/account/img_captcha/?random="+Math.random())})},Auth.prototype.smsSuccessEvent=function(){var t=this;messageBox.showSuccess("短信验证码发送成功"),t.smsCaptcha.addClass("disabled");var e=60;t.smsCaptcha.unbind("click");var n=setInterval(function(){t.smsCaptcha.text(e+"s"),--e<=0&&(clearInterval(n),t.smsCaptcha.removeClass("disabled"),t.smsCaptcha.text("发送验证码"),t.listenSmsCaptchaEvent())},1e3)},Auth.prototype.listenSmsCaptchaEvent=function(){var e=this,n=$(".signup-group input[name='telephone']");smsCaptcha.click(function(){var t=n.val();t||messageBox.showInfo("Please type a telephone number."),xfzajax.get({url:"/account/sms_captcha/",data:{telephone:t},success:function(t){200==t.code&&e.smsSuccessEvent()},fail:function(t){console.log(t)}})})},$(function(){(new Auth).run()}),$(function(){(new FrontBase).run()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb250X2Jhc2UuanMiXSwibmFtZXMiOlsiRnJvbnRCYXNlIiwiZ2V0Q29va2llIiwibmFtZSIsImNvb2tpZVZhbHVlIiwiZG9jdW1lbnQiLCJjb29raWUiLCJjb29raWVzIiwic3BsaXQiLCJpIiwibGVuZ3RoIiwialF1ZXJ5IiwidHJpbSIsInN1YnN0cmluZyIsImRlY29kZVVSSUNvbXBvbmVudCIsInByb3RvdHlwZSIsInJ1biIsInRoaXMiLCJsaXN0ZW5BdXRoQm94SG92ZXIiLCJhdXRoQm94IiwiJCIsInVzZXJNb3JlQm94IiwiaG92ZXIiLCJzaG93IiwiaGlkZSIsIm15YWpheCIsImdldCIsImFyZ3MiLCJhamF4IiwicG9zdCIsIl9hamF4U2V0dXAiLCJhamF4U2V0dXAiLCJiZWZvcmVTZW5kIiwieGhyIiwic2V0dGluZ3MiLCJ0ZXN0IiwidHlwZSIsImNyb3NzRG9tYWluIiwic2V0UmVxdWVzdEhlYWRlciIsIkF1dGgiLCJzZWxmIiwibWFza1dyYXBwZXIiLCJzY3JvbGxXcmFwcGVyIiwic21zQ2FwdGNoYSIsImxpc3RlblNob3dIaWRlRXZlbnQiLCJsaXN0ZW5Td2l0Y2hFdmVudCIsImxpc3RlblNpZ25pbkV2ZW50IiwibGlzdGVuSW1nQ2FwdGNoYUV2ZW50IiwibGlzdGVuU21zQ2FwdGNoYUV2ZW50Iiwic2hvd0V2ZW50IiwiaGlkZUV2ZW50Iiwic2lnbmluQnRuIiwic2lnbnVwQnRuIiwiY2xvc2VCdG4iLCJjbGljayIsImNzcyIsImxlZnQiLCJjdXJyZW50TGVmdCIsInBhcnNlSW50IiwiYW5pbWF0ZSIsInNpZ25pbkdyb3VwIiwidGVsZXBob25lSW5wdXQiLCJmaW5kIiwicGFzc3dvcmRJbnB1dCIsInJlbWVtYmVySW5wdXQiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwidGVsZXBob25lIiwidmFsIiwicGFzc3dvcmQiLCJyZW1lbWJlciIsInByb3AiLCJ4ZnphamF4IiwidXJsIiwiZGF0YSIsImNzcmZtaWRkbGV3YXJldG9rZW4iLCJzdWNjZXNzIiwicmVzdWx0IiwiY29uc29sZSIsImxvZyIsIndpbmRvdyIsImxvY2F0aW9uIiwicmVsb2FkIiwibWVzc2FnZU9iamVjdCIsImNvbnN0cnVjdG9yIiwiU3RyaW5nIiwibWVzc2FnZUJveCIsImtleSIsIm1lc3NhZ2UiLCJmYWlsIiwiZXJyb3IiLCJpbWdDYXB0Y2hhIiwiYXR0ciIsIk1hdGgiLCJyYW5kb20iLCJzbXNTdWNjZXNzRXZlbnQiLCJzaG93U3VjY2VzcyIsImFkZENsYXNzIiwiY291bnQiLCJ1bmJpbmQiLCJ0aW1lciIsInNldEludGVydmFsIiwidGV4dCIsImNsZWFySW50ZXJ2YWwiLCJyZW1vdmVDbGFzcyIsInNob3dJbmZvIl0sIm1hcHBpbmdzIjoiQUFDQSxTQUFTQSxhQTBEVCxTQUFTQyxVQUFVQyxHQUNmLElBQUlDLEVBQWMsS0FDbEIsR0FBSUMsU0FBU0MsUUFBOEIsS0FBcEJELFNBQVNDLE9BRTVCLElBREEsSUFBSUMsRUFBVUYsU0FBU0MsT0FBT0UsTUFBTSxLQUMzQkMsRUFBSSxFQUFHQSxFQUFJRixFQUFRRyxPQUFRRCxJQUFLLENBQ3JDLElBQUlILEVBQVNLLE9BQU9DLEtBQUtMLEVBQVFFLElBRWpDLEdBQUlILEVBQU9PLFVBQVUsRUFBR1YsRUFBS08sT0FBUyxLQUFRUCxFQUFPLElBQU0sQ0FDdkRDLEVBQWNVLG1CQUFtQlIsRUFBT08sVUFBVVYsRUFBS08sT0FBUyxJQUNoRSxPQUlaLE9BQU9OLEVBbkVYSCxVQUFVYyxVQUFVQyxJQUFNLFdBQ1hDLEtBRU5DLHNCQUdUakIsVUFBVWMsVUFBVUcsbUJBQXFCLFdBQ3JDLElBQUlDLEVBQVVDLEVBQUUsYUFDWkMsRUFBY0QsRUFBRSxrQkFFcEJELEVBQVFHLE1BQU0sV0FDVkQsRUFBWUUsUUFDYixXQUNDRixFQUFZRyxVQXlEcEIsSUFBSUMsT0FBUyxDQUNUQyxJQUFPLFNBQVVDLEdBQ2JBLEVBQWEsT0FBSSxNQUNqQlYsS0FBS1csS0FBS0QsSUFFZEUsS0FBUSxTQUFVRixHQUNkQSxFQUFhLE9BQUksT0FDakJW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TUFBTyxnQ0FBbUNDLEtBQUtDLGFBSXZFdkQsS0FBS3hCLFVBQVVnRixnQkFBa0IsV0FDN0IsSUFBSXZELEVBQU92QixLQUNYcUUsV0FBV1UsWUFBWSxhQUN2QnhELEVBQUtHLFdBQVdzRCxTQUFTLFlBQ3pCLElBQUlDLEVBQVEsR0FDWjFELEVBQUtHLFdBQVd3RCxPQUFPLFNBQ3ZCLElBQUlDLEVBQVFDLFlBQVksV0FDcEI3RCxFQUFLRyxXQUFXMkQsS0FBS0osRUFBUSxPQUM3QkEsR0FDYSxJQUNUSyxjQUFjSCxHQUNkNUQsRUFBS0csV0FBVzZELFlBQVksWUFDNUJoRSxFQUFLRyxXQUFXMkQsS0FBSyxTQUNyQjlELEVBQUtRLDBCQUVWLE1BR1BULEtBQUt4QixVQUFVaUMsc0JBQXdCLFdBQ25DLElBQUlSLEVBQU92QixLQUNQNEMsRUFBaUJ6QyxFQUFFLHlDQUN2QnVCLFdBQVdXLE1BQU0sV0FDYixJQUFJYSxFQUFZTixFQUFlTyxNQUMxQkQsR0FDRG1CLFdBQVdtQixTQUFTLG1DQUV4QmpDLFFBQVE5QyxJQUFJLENBQ1IrQyxJQUFPLHdCQUNQQyxLQUFRLENBQ0pQLFVBQWNBLEdBRWxCUyxRQUFXLFNBQVVDLEdBQ0ssS0FBbEJBLEVBQWEsTUFDYnJDLEVBQUt1RCxtQkFHYk4sS0FBUSxTQUFVQyxHQUNkWixRQUFRQyxJQUFJVyxTQU01QnRFLEVBQUUsWUFDWSxJQUFJbUIsTUFDVnZCLFFBSVJJLEVBQUUsWUFDa0IsSUFBSW5CLFdBQ1ZlIiwiZmlsZSI6ImZyb250X2Jhc2UubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbmZ1bmN0aW9uIEZyb250QmFzZSgpIHtcclxuICAgIFxyXG59XHJcblxyXG5Gcm9udEJhc2UucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgICBzZWxmLmxpc3RlbkF1dGhCb3hIb3ZlcigpO1xyXG59O1xyXG5cclxuRnJvbnRCYXNlLnByb3RvdHlwZS5saXN0ZW5BdXRoQm94SG92ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgYXV0aEJveCA9ICQoXCIuYXV0aC1ib3hcIik7XHJcbiAgICB2YXIgdXNlck1vcmVCb3ggPSAkKFwiLnVzZXItbW9yZS1ib3hcIik7XHJcblxyXG4gICAgYXV0aEJveC5ob3ZlcihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdXNlck1vcmVCb3guc2hvdygpO1xyXG4gICAgfSwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHVzZXJNb3JlQm94LmhpZGUoKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuXHJcblxyXG5cclxuXHJcbi8vIE9wZW4gLyBjbG9zZSBsb2dpbiBwYWdlLlxyXG4vLyAkKGZ1bmN0aW9uICgpIHtcclxuLy8gICAgIC8vIENsaWNrIG9uIGxvZ2luIGJ1dHRvbi5cclxuLy8gICAgICQoXCIjYnRuXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuLy8gICAgICAgICAkKFwiLm1hc2std3JhcHBlclwiKS5zaG93KCk7XHJcbi8vICAgICB9KTtcclxuLy9cclxuLy8gICAgIC8vIENsaWNrIG9uIGNsb3NlIGJ1dHRvbi5cclxuLy8gICAgICQoXCIuY2xvc2UtYnRuXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuLy8gICAgICAgICAkKFwiLm1hc2std3JhcHBlclwiKS5oaWRlKCk7XHJcbi8vICAgICB9KTtcclxuLy8gfSk7XHJcblxyXG5cclxuLy8gTG9naW4gLyByZWdpc3RlciBzd2l0Y2guXHJcbi8vICQoZnVuY3Rpb24gKCkge1xyXG4vLyAgICAgJChcIi5zd2l0Y2hcIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4vLyAgICAgICAgIHZhciBzY3JvbGxXcmFwcGVyID0gJChcIi5zY3JvbGwtd3JhcHBlclwiKTtcclxuLy8gICAgICAgICB2YXIgY3VycmVudExlZnQgPSBzY3JvbGxXcmFwcGVyLmNzcyhcImxlZnRcIik7XHJcbi8vICAgICAgICAgLy8gXCJsZWZ0OiAxMHB4XCIgLT4gXCIxMFwiLlxyXG4vLyAgICAgICAgIGN1cnJlbnRMZWZ0ID0gcGFyc2VJbnQoY3VycmVudExlZnQpO1xyXG4vL1xyXG4vLyAgICAgICAgIGlmIChjdXJyZW50TGVmdCA8IDApIHtcclxuLy8gICAgICAgICAgICAgc2Nyb2xsV3JhcHBlci5hbmltYXRlKHtcImxlZnRcIjogXCIwXCJ9KVxyXG4vLyAgICAgICAgIH0gZWxzZSB7XHJcbi8vICAgICAgICAgICAgIHNjcm9sbFdyYXBwZXIuYW5pbWF0ZSh7XCJsZWZ0XCI6IFwiLTQwMHB4XCJ9KVxyXG4vLyAgICAgICAgIH1cclxuLy8gICAgIH0pO1xyXG4vLyB9KTtcclxuXHJcblxyXG5cclxuLy9jc3Jm6K6+572uXHJcbmZ1bmN0aW9uIGdldENvb2tpZShuYW1lKSB7XHJcbiAgICB2YXIgY29va2llVmFsdWUgPSBudWxsO1xyXG4gICAgaWYgKGRvY3VtZW50LmNvb2tpZSAmJiBkb2N1bWVudC5jb29raWUgIT09ICcnKSB7XHJcbiAgICAgICAgdmFyIGNvb2tpZXMgPSBkb2N1bWVudC5jb29raWUuc3BsaXQoJzsnKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvb2tpZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIGNvb2tpZSA9IGpRdWVyeS50cmltKGNvb2tpZXNbaV0pO1xyXG4gICAgICAgICAgICAvLyBEb2VzIHRoaXMgY29va2llIHN0cmluZyBiZWdpbiB3aXRoIHRoZSBuYW1lIHdlIHdhbnQ/XHJcbiAgICAgICAgICAgIGlmIChjb29raWUuc3Vic3RyaW5nKDAsIG5hbWUubGVuZ3RoICsgMSkgPT09IChuYW1lICsgJz0nKSkge1xyXG4gICAgICAgICAgICAgICAgY29va2llVmFsdWUgPSBkZWNvZGVVUklDb21wb25lbnQoY29va2llLnN1YnN0cmluZyhuYW1lLmxlbmd0aCArIDEpKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGNvb2tpZVZhbHVlO1xyXG59XHJcblxyXG52YXIgbXlhamF4ID0ge1xyXG4gICAgJ2dldCc6IGZ1bmN0aW9uIChhcmdzKSB7XHJcbiAgICAgICAgYXJnc1snbWV0aG9kJ10gPSAnZ2V0JztcclxuICAgICAgICB0aGlzLmFqYXgoYXJncyk7XHJcbiAgICB9LFxyXG4gICAgJ3Bvc3QnOiBmdW5jdGlvbiAoYXJncykge1xyXG4gICAgICAgIGFyZ3NbJ21ldGhvZCddID0gJ3Bvc3QnO1xyXG4gICAgICAgIHRoaXMuX2FqYXhTZXR1cCgpO1xyXG4gICAgICAgIHRoaXMuYWpheChhcmdzKTtcclxuICAgIH0sXHJcbiAgICAnYWpheCc6IGZ1bmN0aW9uIChhcmdzKSB7XHJcbiAgICAgICAgJC5hamF4KGFyZ3MpO1xyXG4gICAgfSxcclxuICAgICdfYWpheFNldHVwJzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICQuYWpheFNldHVwKHtcclxuICAgICAgICAgICAgYmVmb3JlU2VuZDogZnVuY3Rpb24oeGhyLCBzZXR0aW5ncykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCEvXihHRVR8SEVBRHxPUFRJT05TfFRSQUNFKSQvLnRlc3Qoc2V0dGluZ3MudHlwZSkgJiYgIXRoaXMuY3Jvc3NEb21haW4pIHtcclxuICAgICAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcIlgtQ1NSRlRva2VuXCIsIGdldENvb2tpZSgnY3NyZnRva2VuJykpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn07XHJcblxyXG4vLyBDb25zdHJ1Y3Rpb24gZnVuY3Rpb24uXHJcbmZ1bmN0aW9uIEF1dGgoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgc2VsZi5tYXNrV3JhcHBlciA9ICQoXCIubWFzay13cmFwcGVyXCIpO1xyXG4gICAgc2VsZi5zY3JvbGxXcmFwcGVyID0gJChcIi5zY3JvbGwtd3JhcHBlclwiKTtcclxuICAgIHNlbGYuc21zQ2FwdGNoYSA9ICQoXCIuc21zLWNhcHRjaGEtYnRuXCIpO1xyXG59XHJcblxyXG5BdXRoLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgc2VsZi5saXN0ZW5TaG93SGlkZUV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlblN3aXRjaEV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlblNpZ25pbkV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlbkltZ0NhcHRjaGFFdmVudCgpO1xyXG4gICAgc2VsZi5saXN0ZW5TbXNDYXB0Y2hhRXZlbnQoKTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLnNob3dFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIC8vIFNob3cgc2luZ2luL3NpZ251cCB3aW5kb3cuXHJcbiAgICBzZWxmLm1hc2tXcmFwcGVyLnNob3coKTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmhpZGVFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIC8vIEhpZGUgc2lnbmluL3NpZ251cCB3aW5kb3cuXHJcbiAgICBzZWxmLm1hc2tXcmFwcGVyLmhpZGUoKTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNob3dIaWRlRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgc2lnbmluQnRuID0gJChcIi5zaWduaW4tYnRuXCIpO1xyXG4gICAgdmFyIHNpZ251cEJ0biA9ICQoXCIuc2lnbnVwLWJ0blwiKTtcclxuICAgIHZhciBjbG9zZUJ0biA9ICQoXCIuY2xvc2UtYnRuXCIpO1xyXG5cclxuICAgIC8vIENsaWNrIHNpZ25pbiBidXR0b24gdG8gb3BlbiBzaWduaW4gd2luZG93LlxyXG4gICAgc2lnbmluQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzZWxmLnNob3dFdmVudCgpO1xyXG4gICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5jc3Moe1wibGVmdFwiOiAwfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBDbGljayBzaWdudXAgYnV0dG9uIHRvIG9wZW4gc2lnbnVwIHdpbmRvdy5cclxuICAgIHNpZ251cEJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5zaG93RXZlbnQoKTtcclxuICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuY3NzKHtcImxlZnRcIjogLTQwMH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gQ2xpY2sgY2xvc2UgYnV0dG9uIHRvIGNsb3NlIHNpZ25pbi9zaWdudXAgd2luZG93LlxyXG4gICAgY2xvc2VCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlbGYuaGlkZUV2ZW50KCk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbi8vIFNpZ25pbi9zaWdudXAgd2luZG93IHN3aXRjaC5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuU3dpdGNoRXZlbnQgPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBzd2l0Y2hlciA9ICQoXCIuc3dpdGNoXCIpO1xyXG5cclxuICAgIHN3aXRjaGVyLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgY3VycmVudExlZnQgPSBzZWxmLnNjcm9sbFdyYXBwZXIuY3NzKFwibGVmdFwiKTtcclxuICAgICAgICAvLyBcImxlZnQ6IDEwcHhcIiAtPiBcIjEwXCIuXHJcbiAgICAgICAgY3VycmVudExlZnQgPSBwYXJzZUludChjdXJyZW50TGVmdCk7XHJcblxyXG4gICAgICAgIGlmIChjdXJyZW50TGVmdCA8IDApIHtcclxuICAgICAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmFuaW1hdGUoe1wibGVmdFwiOiBcIjBcIn0pXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmFuaW1hdGUoe1wibGVmdFwiOiBcIi00MDBweFwifSlcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNpZ25pbkV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHNpZ25pbkdyb3VwID0gJChcIi5zaWduaW4tZ3JvdXBcIik7XHJcbiAgICB2YXIgdGVsZXBob25lSW5wdXQgPSBzaWduaW5Hcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ndGVsZXBob25lJ11cIik7XHJcbiAgICB2YXIgcGFzc3dvcmRJbnB1dCA9IHNpZ25pbkdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdwYXNzd29yZCddXCIpO1xyXG4gICAgdmFyIHJlbWVtYmVySW5wdXQgPSBzaWduaW5Hcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncmVtZW1iZXInXVwiKTtcclxuXHJcbiAgICB2YXIgc3VibWl0QnRuID0gc2lnbmluR3JvdXAuZmluZChcIi5zdWJtaXQtYnRuXCIpO1xyXG4gICAgc3VibWl0QnRuLmNsaWNrKGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbGVwaG9uZUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZCA9IHBhc3N3b3JkSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHJlbWVtYmVyID0gcmVtZW1iZXJJbnB1dC5wcm9wKFwiY2hlY2tlZFwiKTtcclxuXHJcbiAgICAgICAgeGZ6YWpheC5wb3N0KHtcclxuICAgICAgICAgICAgJ3VybCc6ICcvYWNjb3VudC9sb2dpbi8nLFxyXG4gICAgICAgICAgICAnZGF0YSc6IHtcclxuICAgICAgICAgICAgICAgICd0ZWxlcGhvbmUnOiB0ZWxlcGhvbmUsXHJcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQnOiBwYXNzd29yZCxcclxuICAgICAgICAgICAgICAgICdyZW1lbWJlcic6IHJlbWVtYmVyPzE6MCxcclxuICAgICAgICAgICAgICAgICdjc3JmbWlkZGxld2FyZXRva2VuJzogJCgnI2NzcmZfdG9rZW4nKS52YWwoKVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Wydjb2RlJ10gPT09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaGlkZUV2ZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTG9naW4gZmFpbGVkLicpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlT2JqZWN0ID0gcmVzdWx0WydtZXNzYWdlJ107XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtZXNzYWdlT2JqZWN0ID09ICdzdHJpbmcnIHx8IG1lc3NhZ2VPYmplY3QuY29uc3RydWN0b3IgPT0gU3RyaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG1lc3NhZ2VPYmplY3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93KG1lc3NhZ2VPYmplY3QpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBtZXNzYWdlT2JqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZXMgPSBtZXNzYWdlT2JqZWN0W2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZSA9IG1lc3NhZ2VzWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93KG1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnZmFpbCc6IGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gbXlhamF4LnBvc3Qoe1xyXG4gICAgICAgIC8vICAgICAndXJsJzogJy9hY2NvdW50L2xvZ2luLycsXHJcbiAgICAgICAgLy8gICAgICdkYXRhJzoge1xyXG4gICAgICAgIC8vICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZSxcclxuICAgICAgICAvLyAgICAgICAgICdwYXNzd29yZCc6IHBhc3N3b3JkLFxyXG4gICAgICAgIC8vICAgICAgICAgJ3JlbWVtYmVyJzogcmVtZW1iZXI/MTowLFxyXG4gICAgICAgIC8vICAgICAgICAgJ2NzcmZtaWRkbGV3YXJldG9rZW4nOiAkKCcjY3NyZl90b2tlbicpLnZhbCgpXHJcbiAgICAgICAgLy8gICAgIH0sXHJcbiAgICAgICAgLy8gICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgIC8vICAgICAgICAgY29uc29sZS5sb2coJz09PT09PT09PT09PT09Jyk7XHJcbiAgICAgICAgLy8gICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG4gICAgICAgIC8vICAgICAgICAgY29uc29sZS5sb2coJz09PT09PT09PT09PT09Jyk7XHJcbiAgICAgICAgLy8gICAgIH0sXHJcbiAgICAgICAgLy8gICAgICdmYWlsJzogZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgLy8gICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAvLyB9KTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuSW1nQ2FwdGNoYUV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGltZ0NhcHRjaGEgPSAkKCcuaW1nLWNhcHRjaGEnKTtcclxuICAgIGltZ0NhcHRjaGEuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGltZ0NhcHRjaGEuYXR0cihcInNyY1wiLCBcIi9hY2NvdW50L2ltZ19jYXB0Y2hhL1wiK1wiP3JhbmRvbT1cIitNYXRoLnJhbmRvbSgpKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUuc21zU3VjY2Vzc0V2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgbWVzc2FnZUJveC5zaG93U3VjY2Vzcygn55+t5L+h6aqM6K+B56CB5Y+R6YCB5oiQ5YqfJyk7XHJcbiAgICBzZWxmLnNtc0NhcHRjaGEuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7ICAgIC8vIOWwhuWPkemAgemqjOivgeeggeaMiemSruWPmOaIkOeBsOiJslxyXG4gICAgdmFyIGNvdW50ID0gNjA7ICAgICAvLyA2MOenkuWAkuiuoeaXtlxyXG4gICAgc2VsZi5zbXNDYXB0Y2hhLnVuYmluZCgnY2xpY2snKTsgICAgIC8vIOWPlua2iOaMiemSrueCueWHu1xyXG4gICAgdmFyIHRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlbGYuc21zQ2FwdGNoYS50ZXh0KGNvdW50ICsgXCJzXCIpOyAgICAgLy8g5pi+56S65YCS6K6h5pe2XHJcbiAgICAgICAgY291bnQtLTsgICAgLy8g5YCS6K6h5pe26Ieq5YePMVxyXG4gICAgICAgIGlmIChjb3VudCA8PSAwKSB7XHJcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpOyAgIC8v5YCS6K6h5pe2NjDnp5Lnu5PmnZ/vvIzlgZzmraLlgJLorqHml7ZcclxuICAgICAgICAgICAgc2VsZi5zbXNDYXB0Y2hhLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpOyAgICAgLy8g5bCG5Y+R6YCB5oyJ6ZKu5Y+Y5Zue5q2j5bi45pi+56S6XHJcbiAgICAgICAgICAgIHNlbGYuc21zQ2FwdGNoYS50ZXh0KCflj5HpgIHpqozor4HnoIEnKTsgICAvLyDmjInpkq7mloflrZflj5jlm57mraPluLjmmL7npLpcclxuICAgICAgICAgICAgc2VsZi5saXN0ZW5TbXNDYXB0Y2hhRXZlbnQoKTsgICAvLyDph43mlrDmiafooYzlh73mlbBcclxuICAgICAgICB9XHJcbiAgICB9LCAxMDAwKTsgICAvLyDlgJLorqHml7bpl7TpmpQxMDAw5q+r56eSXHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TbXNDYXB0Y2hhRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgdGVsZXBob25lSW5wdXQgPSAkKFwiLnNpZ251cC1ncm91cCBpbnB1dFtuYW1lPSd0ZWxlcGhvbmUnXVwiKTtcclxuICAgIHNtc0NhcHRjaGEuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0ZWxlcGhvbmUgPSB0ZWxlcGhvbmVJbnB1dC52YWwoKTtcclxuICAgICAgICBpZiAoIXRlbGVwaG9uZSkge1xyXG4gICAgICAgICAgICBtZXNzYWdlQm94LnNob3dJbmZvKCdQbGVhc2UgdHlwZSBhIHRlbGVwaG9uZSBudW1iZXIuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHhmemFqYXguZ2V0KHtcclxuICAgICAgICAgICAgJ3VybCc6ICcvYWNjb3VudC9zbXNfY2FwdGNoYS8nLFxyXG4gICAgICAgICAgICAnZGF0YSc6IHtcclxuICAgICAgICAgICAgICAgICd0ZWxlcGhvbmUnIDogdGVsZXBob25lXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdFsnY29kZSddID09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc21zU3VjY2Vzc0V2ZW50KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdmYWlsJzogZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSk7XHJcbn07XHJcblxyXG4kKGZ1bmN0aW9uICgpIHtcclxuICAgdmFyIGF1dGggPSBuZXcgQXV0aCgpO1xyXG4gICBhdXRoLnJ1bigpO1xyXG59KTtcclxuXHJcblxyXG4kKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBmcm9udEJhc2UgPSBuZXcgRnJvbnRCYXNlKCk7XHJcbiAgICBmcm9udEJhc2UucnVuKCk7XHJcbn0pO1xyXG5cclxuLy8gdmFyIHN1Ym1pdEJ0biA9IHNpZ25pbkdyb3VwLmZpbmQoXCIuc3VibWl0LWJ0blwiKTtcclxuLy8gc3VibWl0QnRuLmNsaWNrKGZ1bmN0aW9uIChldmVudCkge1xyXG4vLyAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuLy8gICAgIHZhciB0ZWxlcGhvbmUgPSB0ZWxlcGhvbmVJbnB1dC52YWwoKTtcclxuLy8gICAgIHZhciBwYXNzd29yZCA9IHBhc3N3b3JkSW5wdXQudmFsKCk7XHJcbi8vICAgICB2YXIgcmVtZW1iZXIgPSByZW1lbWJlcklucHV0LnByb3AoXCJjaGVja2VkXCIpO1xyXG4vL1xyXG4vLyAgICAgbXlhamF4LnBvc3Qoe1xyXG4vLyAgICAgICAgICd1cmwnOiAnL2FjY291bnQvbG9naW4vJyxcclxuLy8gICAgICAgICAnZGF0YSc6IHtcclxuLy8gICAgICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZSxcclxuLy8gICAgICAgICAgICAgJ3Bhc3N3b3JkJzogcGFzc3dvcmQsXHJcbi8vICAgICAgICAgICAgICdyZW1lbWJlcic6IHJlbWVtYmVyPzE6MFxyXG4vLyAgICAgICAgIH0sXHJcbi8vICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbi8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKCc9PT09PT09PT09PT09PScpO1xyXG4vLyAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG4vLyAgICAgICAgICAgICBjb25zb2xlLmxvZygnPT09PT09PT09PT09PT0nKTtcclxuLy8gICAgICAgICB9LFxyXG4vLyAgICAgICAgICdmYWlsJzogZnVuY3Rpb24gKGVycm9yKSB7XHJcbi8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuLy8gICAgICAgICB9XHJcbi8vICAgICB9KTtcclxuLy8gfSk7XHJcblxyXG5cclxuIl19
